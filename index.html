<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Abrox</title>
  <!-- Tailwind CDN -->
  <script>
    tailwind = window.tailwind || {};
    tailwind.config = { theme: { extend: { boxShadow: { 'soft-xl': '0 20px 60px rgba(0,0,0,0.55), inset 0 -4px 20px rgba(0,0,0,0.2)' } } } };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* ---------- Base ---------- */
    html { -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%; }
    body, button, input { -webkit-tap-highlight-color: transparent; }
    :root{
      --card-bg: rgba(255,255,255,0.02);
      --card-bg-2: rgba(255,255,255,0.018);
      --card-shadow: 0 10px 30px rgba(2,6,23,0.45);
      --glass-stroke: rgba(255,255,255,0.035);
      --glass-highlight: rgba(255,255,255,0.02);
    }

    /* ---------- Logo / Hero ---------- */
    .site-logo { max-width: 220px; transition: transform .22s ease, opacity .22s ease; opacity:.95; display:block; margin:0 auto; }
    @media (min-width:640px){ .site-logo { max-width: 360px; } }
    .hero-img { max-width:960px; display:block; margin:0 auto; }

    /* ---------- Video (pulsing play) ---------- */
    .video-card { position: relative; border-radius: .75rem; overflow: hidden; background: #000; border: 1px solid rgba(255,255,255,0.06); box-shadow: var(--card-shadow); }
    .play-btn { width:84px; height:84px; border-radius:9999px; display:flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.96); box-shadow: 0 12px 30px rgba(0,0,0,0.45); cursor:pointer; border:none; animation: pulseScale 2.6s ease-in-out infinite; }
    @keyframes pulseScale { 0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)} }
    .video-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none; }
    .video-overlay .play-btn { pointer-events:auto; }
    video { width:100%; height:100%; display:block; }
    .unmute-hint { position:absolute; left:50%; transform:translateX(-50%); bottom:12px; background:rgba(0,0,0,0.7); color:#fff; padding:.4rem .75rem; border-radius:999px; font-size:.85rem; opacity:0; transition:opacity .18s; pointer-events:none; }
    .spinner { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(0,0,0,0.45); }

    /* ---------- CTA exact sizing ---------- */
    .cta-wrap { width:100%; display:flex; flex-direction:column; align-items:center; gap:22px; margin-top:1.5rem; }

    /* BUY large full-width */
    .buy-btn {
      width:100%;
      max-width:900px;
      min-height:110px;
      padding:0 28px;
      border-radius:18px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      font-size:34px;
      line-height:1;
      white-space:nowrap;
      box-shadow:0 18px 48px rgba(0,0,0,0.5), inset 0 -6px 18px rgba(0,0,0,0.08);
      text-decoration:none;
      color:#fff;
      background: linear-gradient(90deg,#25b86a,#059669);
      border: 1px solid rgba(255,255,255,0.02);
      transform: translateZ(0) scale(1);
    }
    @media (max-width:480px){
      .buy-btn { min-height:88px; font-size:22px; padding:0 16px; max-width: 96%; border-radius:14px; }
    }
    .buy-pulse { animation: buyPulse 2.6s cubic-bezier(.25,.8,.25,1) infinite; will-change: transform, box-shadow, filter; }
    @keyframes buyPulse {
      0% { transform: translateY(0) scale(1); box-shadow:0 18px 48px rgba(0,0,0,0.45), inset 0 -6px 18px rgba(0,0,0,0.08); }
      45% { transform: translateY(-3px) scale(1.02); box-shadow:0 28px 64px rgba(16,185,129,0.16), inset 0 -6px 18px rgba(0,0,0,0.06); }
      100% { transform: translateY(0) scale(1); box-shadow:0 18px 48px rgba(0,0,0,0.45), inset 0 -6px 18px rgba(0,0,0,0.08); }
    }

    /* DOWNLOAD medium */
    .download-btn {
      width:360px;
      max-width:85%;
      min-height:72px;
      padding:0 22px;
      border-radius:14px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:14px;
      font-weight:800;
      font-size:20px;
      white-space:nowrap;
      text-decoration:none;
      color:#fff;
      background: linear-gradient(90deg,#3b82f6,#60a5fa);
      box-shadow: 0 12px 30px rgba(59,130,246,0.12);
      border: 1px solid rgba(255,255,255,0.02);
    }
    @media (max-width:480px){
      .download-btn { width:68%; min-height:64px; font-size:18px; padding:0 16px; }
    }
    .phone-icon{ width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center; flex-shrink:0; }
    .phone-icon svg{ width:22px;height:22px; stroke: currentColor; fill:none; stroke-width:2.4; }

    /* ---------- Brokers ---------- */
    .broker-logo-wrap{ width:76px; height:76px; border-radius:9999px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.02); }
    .broker-logo{ width:70%; height:70%; object-fit:contain; display:block; }
    .broker-card{ background:linear-gradient(180deg,var(--card-bg-2),var(--card-bg)); border:1px solid rgba(255,255,255,0.03); box-shadow:var(--card-shadow); border-radius:14px; padding:1rem; display:flex; flex-direction:column; align-items:center; gap:.75rem; min-height:130px; }

    /* ---------- GLASS stat card (replaces green panel) ---------- */
    .glass-card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: 14px;
      padding: 18px;
      border: 1px solid var(--glass-stroke);
      box-shadow: 0 16px 40px rgba(2,6,23,0.5), inset 0 1px 0 var(--glass-highlight);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      color: #e6e8eb;
    }

    .glass-inner {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }

    .glass-left {
      display:flex;
      flex-direction:column;
      gap:6px;
      flex: 1 1 auto;
    }

    .glass-label {
      color: rgba(255,255,255,0.76);
      font-weight:600;
      font-size:16px;
    }

    .glass-percent {
      font-weight:900;
      color: #34d399; /* bright green */
      line-height:0.95;
      font-size:80px;
      letter-spacing: -1px;
      margin-top:6px;
    }
    @media (max-width:640px) {
      .glass-percent { font-size:56px; }
    }

    .glass-ops {
      color: rgba(255,255,255,0.78);
      font-size:15px;
      margin-top:6px;
    }

    .glass-badge {
      flex: 0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      width:96px;
      height:96px;
      margin-left: 8px;
    }
    @media (max-width:480px) {
      .glass-badge { width:72px; height:72px; }
      .glass-inner { gap:10px; }
    }

    /* Chart card */
    .chart-card {
      border-radius: 14px;
      padding: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.006));
      border: 1px solid rgba(255,255,255,0.03);
      box-shadow: var(--card-shadow);
    }

    .legend-square { width:18px; height:18px; border-radius:6px; background: linear-gradient(90deg,#16a34a,#34d399); box-shadow: 0 6px 16px rgba(16,185,129,0.12); display:inline-block; }

    .muted { color: rgba(255,255,255,0.58); }

    .chart-canvas { width:100%; height:260px; }
    @media (max-width:480px) { .chart-canvas { height:220px; } }

    /* limited pill flame */
    .limited-pill { background: linear-gradient(90deg,#ff6b5f,#e0443a); box-shadow: 0 8px 28px rgba(224,68,58,0.16); }
    .flame-emoji { display:inline-block; transform-origin:center; animation: flamePulse 1.6s ease-in-out infinite; will-change: transform, filter, opacity; font-size: 18px; line-height:1; }
    @keyframes flamePulse { 0%{transform:scale(1)}45%{transform:scale(1.08) translateY(-1%)}100%{transform:scale(1)} }
    @media (prefers-reduced-motion: reduce) { .flame-emoji, .buy-pulse { animation: none; } }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-[#03060a] via-[#050a12] to-[#020407] text-[#e6e8eb] antialiased">
  <div class="relative z-10 max-w-[1100px] mx-auto px-4">

    <!-- Logo -->
    <header class="flex justify-center pt-4 pb-1">
      <div class="w-full flex justify-center">
        <img src="assets/logo.png" alt="Abrox Logo" class="site-logo object-contain" loading="eager" decoding="async">
      </div>
    </header>

    <!-- Hero -->
    <section class="flex justify-center hero">
      <div class="w-full max-w-[960px] my-3">
        <img src="assets/hero.png" alt="Hero" class="hero-img w-full rounded-xl object-contain" width="1200" height="560" loading="lazy" decoding="async">
      </div>
    </section>

    <!-- Video -->
    <section class="flex justify-center">
      <div class="w-full max-w-[900px]">
        <div class="video-card aspect-video">
          <video id="demoVideo" controls playsinline preload="metadata" poster="assets/poster.jpg" class="w-full h-full" aria-label="Demo video" controlsList="nodownload noremoteplayback" disablePictureInPicture oncontextmenu="return false;">
            <source src="assets/demo.mp4" type="video/mp4">
            Your browser does not support HTML5 video.
          </video>

          <div class="video-overlay" id="videoOverlay" aria-hidden="true">
            <button id="playBtn" class="play-btn" aria-label="Play demo">
              <svg viewBox="0 0 24 24" width="36" height="36" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M8 5v14l11-7-11-7z" fill="#000"/></svg>
            </button>
          </div>

          <div class="spinner hidden" id="loadingSpinner"><div style="width:40px;height:40px;border:3px solid rgba(255,255,255,0.25);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite"></div></div>
          <div class="unmute-hint" id="unmuteHint">ðŸ”Š Tap to unmute</div>
        </div>
      </div>
    </section>

    <!-- CTAs -->
    <div class="cta-wrap">
      <a id="buyBtn" class="buy-btn buy-pulse" href="#checkout" aria-label="Buy now">BUY NOW</a>

      <a id="downloadBtn" class="download-btn" href="#download" aria-label="Download App">
        <span class="phone-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="28" height="28" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" focusable="false">
            <rect x="6" y="2" width="12" height="20" rx="2" stroke="currentColor" stroke-width="2.4" fill="none" />
            <circle cx="12" cy="18.2" r="1.6" fill="currentColor" />
          </svg>
        </span>
        <span>Download App</span>
      </a>
    </div>

    <!-- Brokers -->
    <section class="mt-12 px-2 w-full">
      <div class="max-w-[1024px] mx-auto">
        <h2 class="text-center text-2xl sm:text-3xl font-bold mb-6">Compatible Brokers</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-5">
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/iq-option.png" alt="IQ Option" class="broker-logo"></div><div class="broker-label">IQ OPTION</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/quotex.png" alt="QUOTEX" class="broker-logo"></div><div class="broker-label">QUOTEX</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/pocket-option.png" alt="Pocket Option" class="broker-logo"></div><div class="broker-label">POCKET OPTION</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/polarium-broker.png" alt="Polarium Broker" class="broker-logo"></div><div class="broker-label">POLARIUM BROKER</div></div>

          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/expert-option.jpeg" alt="Expert Option" class="broker-logo"></div><div class="broker-label">EXPERT OPTION</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/binomo.png" alt="Binomo" class="broker-logo"></div><div class="broker-label">BINOMO</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/olymp-trade.png" alt="Olymp Trade" class="broker-logo"></div><div class="broker-label">OLYMP TRADE</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/home-broker.png" alt="Home Broker" class="broker-logo"></div><div class="broker-label">HOME BROKER</div></div>

          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/exnova.png" alt="Exnova" class="broker-logo"></div><div class="broker-label">EXNOVA</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/avalon.png" alt="Avalon" class="broker-logo"></div><div class="broker-label">AVALON</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/bullex.jpeg" alt="Bullex" class="broker-logo"></div><div class="broker-label">BULLEX</div></div>
          <div class="broker-card"><div class="broker-logo-wrap"><img src="assets/brokers/ebinex.png" alt="Ebinex" class="broker-logo"></div><div class="broker-label">EBINEX</div></div>
        </div>
      </div>
    </section>

    <!-- PRICING block -->
    <section class="mt-10 px-4 w-full max-w-[1024px] mx-auto" role="region" aria-labelledby="pricing-title">
      <h2 id="pricing-title" class="sr-only">Black Friday Pricing</h2>

      <div class="pricing-card p-6 md:p-8">
        <div class="flex items-center pricing-columns gap-6">
          <div class="w-1/3 min-w-[130px] flex flex-col items-center justify-center text-center">
            <div class="text-sm text-white/60 uppercase">Regular Price:</div>
            <div class="mt-3"><span class="strike text-2xl md:text-3xl font-bold text-white/60">$500/year</span></div>
          </div>
          <div class="pricing-divider h-20 border-r border-white/6"></div>
          <div class="flex-1 price-display pl-3">
            <div class="text-sm md:text-base font-extrabold uppercase text-green-400">BLACK FRIDAY SPECIAL:</div>
            <div class="mt-2"><span class="text-[48px] md:text-[64px] font-extrabold text-green-500 leading-none">$399</span></div>
            <div class="mt-3 uppercase text-lg md:text-xl font-semibold tracking-wide"><div>LIFETIME</div><div>ACCESS</div></div>
          </div>
        </div>

        <div class="mt-6 flex flex-col items-center gap-4">
          <button type="button" class="limited-pill inline-flex items-center gap-3 text-white font-semibold rounded-full px-5 py-3 text-base" aria-hidden="false" aria-label="Limited time offer">
            <span class="flame-emoji" aria-hidden="true">ðŸ”¥</span>
            <span>LIMITED TIME OFFER</span>
          </button>

          <a id="buyNowPricing" href="#checkout" class="pricing-cta w-full max-w-[600px] inline-flex items-center justify-center rounded-2xl py-5 px-6 bg-gradient-to-r from-green-600 to-green-500 text-white font-extrabold text-2xl shadow-[0_12px_36px_rgba(0,0,0,0.45)]" aria-label="Buy lifetime access for $399 â€” Black Friday special">
            BUY NOW
          </a>

          <p class="mt-2 text-center text-white/60">Click the button above to unlock your access</p>
        </div>
      </div>
    </section>

    <!-- ACCURACY (glass card) -->
    <section id="accuracy" class="mt-8 px-4 w-full max-w-[1024px] mx-auto" aria-labelledby="accuracy-title">
      <h2 id="accuracy-title" class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-center leading-tight">EUR/USD Accuracy Rate</h2>
      <p class="text-center muted mt-2 mb-4">Last 7 days performance</p>

      <!-- Broker select -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6">
        <label for="brokerSelect" class="font-semibold mr-2">Broker:</label>
        <select id="brokerSelect" class="bg-[#0b1220] rounded-xl px-4 py-3 border border-white/6 text-white/90 min-w-[200px]">
          <option>IQ OPTION</option>
          <option>QUOTEX</option>
          <option>POCKET OPTION</option>
          <option>POLARIUM BROKER</option>
          <option>EXPERT OPTION</option>
          <option>BINOMO</option>
          <option>OLYMP TRADE</option>
          <option>HOME BROKER</option>
          <option>EXNOVA</option>
          <option>AVALON</option>
          <option>BULLEX</option>
          <option>EBINEX</option>
        </select>
      </div>

      <!-- Glass stat card -->
      <div class="glass-card mb-6" role="region" aria-labelledby="avg-acc">
        <div class="glass-inner">
          <div class="glass-left">
            <div id="avg-acc" class="glass-label">Average Accuracy</div>
            <div id="avgPercent" class="glass-percent" aria-live="polite">--.-%</div>
            <div id="opsCount" class="glass-ops">Based on â€” operations of 1 minute</div>
          </div>

          <div class="glass-badge" aria-hidden="true">
            <!-- PCI badge -->
            <img src="assets/pci-badge.png" alt="" style="width:100%;height:auto;opacity:0.98;object-fit:contain;">
          </div>
        </div>
      </div>

      <!-- Chart card -->
      <div class="chart-card">
        <canvas id="accuracyChart" class="chart-canvas" role="img" aria-label="Accuracy chart for last 7 days"></canvas>
        <div id="chartFallback" class="sr-only" aria-hidden="false"></div>
      </div>

      <div class="mt-6 flex items-center justify-center gap-3">
        <span class="legend-square" aria-hidden="true"></span>
        <span class="muted">Accuracy Rate</span>
      </div>
    </section>

    <!-- Footer -->
    <footer class="mt-12 border-t border-white/10"><p class="text-center text-sm text-white/60 py-6">Â© 2026 Abrox. All rights reserved.</p></footer>
  </div>

  <!-- Lucide (optional) -->
  <script src="https://unpkg.com/lucide@latest/dist/lucide.min.js" defer></script>

  <!-- Chart.js + datalabels plugin (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      if (window.lucide && typeof window.lucide.replace === 'function') window.lucide.replace();

      // video overlay helpers
      const video = document.getElementById('demoVideo');
      const playBtn = document.getElementById('playBtn');
      const overlay = document.getElementById('videoOverlay');
      const spinner = document.getElementById('loadingSpinner');
      const unmuteHint = document.getElementById('unmuteHint');
      function showOverlay(show){ if(!overlay) return; overlay.style.opacity = show ? '1' : '0'; overlay.style.pointerEvents = show ? 'auto' : 'none'; }
      if (playBtn && video){
        playBtn.addEventListener('click', function (e) {
          e.stopPropagation();
          if (video.paused){
            if (spinner) spinner.classList.remove('hidden');
            video.play().then(()=> { if (spinner) spinner.classList.add('hidden'); showOverlay(false); }).catch(()=> { if (spinner) spinner.classList.add('hidden'); });
          } else { video.pause(); showOverlay(true); }
        });
      }
      if (video){
        video.addEventListener('play', ()=>{ showOverlay(false); if(video.muted && unmuteHint) unmuteHint.style.opacity='1'; });
        video.addEventListener('pause', ()=>{ showOverlay(true); if(unmuteHint) unmuteHint.style.opacity='0'; });
        video.addEventListener('canplay', ()=>{ if (spinner) spinner.classList.add('hidden'); if(!video.paused) showOverlay(false); });
        video.addEventListener('volumechange', ()=>{ if(!video.muted && unmuteHint) unmuteHint.style.opacity='0'; });
      }
      setTimeout(()=> { if (video && video.paused) showOverlay(true); }, 300);

      const style = document.createElement('style');
      style.innerHTML = '@keyframes spin{to{transform:rotate(360deg)}}';
      document.head.appendChild(style);
      if (video) {
        video.addEventListener('contextmenu', function (e) { e.preventDefault(); });
        video.addEventListener('dragstart', function (e) { e.preventDefault(); });
        video.addEventListener('touchstart', function (e) { }, { passive: true });
      }
      document.addEventListener('keydown', function(e){
        if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S')) e.preventDefault();
        if ((e.ctrlKey || e.metaKey) && e.shiftKey && (e.key === 'I' || e.key === 'i')) e.preventDefault();
      });
      document.addEventListener('contextmenu', function(e){
        if (e.target && (e.target.closest && e.target.closest('.video-card'))) e.preventDefault();
      });

      // === ACCURACY CHART LOGIC ===
      if (window.Chart && window.Chart.register) Chart.register(ChartDataLabels);

      function formatOneDecimal(n) { return (Math.round(n * 10) / 10).toFixed(1); }
      function randRange(min, max) { return Math.random() * (max - min) + min; }

      function getLast7DayLabels() {
        const labels = []; const now = new Date();
        for (let i = 6; i >= 0; i--) {
          const d = new Date(now); d.setDate(now.getDate() - i);
          const month = d.toLocaleString(undefined, { month: 'short' });
          const day = d.getDate();
          labels.push(month + '\n' + day);
        }
        return labels;
      }

      function generateSmoothedValues(baseMean = 83, volatility = 3.2) {
        const values = [];
        let prev = baseMean + randRange(-1.6, 1.6);
        for (let i = 0; i < 7; i++) {
          const alpha = 0.6 + Math.random() * 0.25;
          const noise = randRange(-volatility, volatility);
          const next = prev * alpha + (baseMean * (1 - alpha)) + noise * (1 - alpha * 0.5);
          const clamped = Math.max(60, Math.min(98, Math.round(next * 10) / 10));
          values.push(clamped);
          prev = clamped;
        }
        return values;
      }

      function createGradient(ctx, chartArea) {
        const gradient = ctx.createLinearGradient(0, chartArea.top, 0, chartArea.bottom);
        gradient.addColorStop(0, 'rgba(20,184,166,0.16)');
        gradient.addColorStop(0.45, 'rgba(20,184,166,0.08)');
        gradient.addColorStop(1, 'rgba(20,184,166,0.00)');
        return gradient;
      }

      let accuracyChart = null;
      function renderChart(labels, values) {
        const ctx = document.getElementById('accuracyChart').getContext('2d');
        const minVal = Math.min(...values); const maxVal = Math.max(...values);
        const suggestedMin = Math.max(60, Math.floor(minVal - 3));
        const suggestedMax = Math.min(100, Math.ceil(maxVal + 3));

        if (accuracyChart) {
          accuracyChart.data.labels = labels;
          accuracyChart.data.datasets[0].data = values;
          accuracyChart.options.scales.y.suggestedMin = suggestedMin;
          accuracyChart.options.scales.y.suggestedMax = suggestedMax;
          accuracyChart.update();
          return;
        }

        accuracyChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: 'Accuracy',
              data: values,
              tension: 0.28,
              borderWidth: 3,
              borderColor: '#10b981',
              pointBackgroundColor: '#34d399',
              pointBorderColor: '#093927',
              pointRadius: 6,
              pointHoverRadius: 8,
              fill: true,
              backgroundColor: function(context) {
                const chart = context.chart;
                const { ctx, chartArea } = chart;
                if (!chartArea) return null;
                return createGradient(ctx, chartArea);
              },
            }]
          },
          options: {
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                enabled: true,
                backgroundColor: '#00140f',
                titleColor: '#fff',
                bodyColor: '#d7fff0',
                callbacks: { label: function(context) { return context.parsed.y + '%'; } }
              },
              datalabels: {
                color: '#34d399',
                anchor: 'end',
                align: 'start',
                offset: -8,
                font: { weight: '700', size: 11 },
                formatter: function(value) { return value + '%'; }
              }
            },
            elements: { line: { borderCapStyle: 'round' } },
            scales: {
              x: { grid: { display: false }, ticks: { color: 'rgba(255,255,255,0.6)', font: { size: 12 }, callback: function(value, index) { return this.getLabelForValue(index); } } },
              y: {
                beginAtZero: false,
                suggestedMin: suggestedMin,
                suggestedMax: suggestedMax,
                grid: { color: 'rgba(255,255,255,0.03)', borderDash: [4,6] },
                ticks: { color: 'rgba(255,255,255,0.42)', stepSize: 5, callback: function(val) { return val + '%'; } }
              }
            },
            animation: { duration: (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) ? 0 : 800, easing: 'easeOutCubic' },
            interaction: { mode: 'nearest', intersect: false },
            responsive: true,
            maintainAspectRatio: false
          }
        });
      }

      function updateStatCard(values) {
        const avg = values.reduce((s, v) => s + v, 0) / values.length;
        const avgText = formatOneDecimal(avg) + '%';
        document.getElementById('avgPercent').innerText = avgText;
        const ops = Math.floor(randRange(800, 1600));
        document.getElementById('opsCount').innerText = 'Based on ' + ops.toLocaleString() + ' operations of 1 minute';

        const labels = getLast7DayLabels().map(l => l.replace('\n', ' '));
        const fallbackItems = labels.map((lab, i) => lab + ': ' + values[i] + '%').join('; ');
        const fallbackEl = document.getElementById('chartFallback');
        fallbackEl.innerText = 'Last seven days: ' + fallbackItems + '. Average: ' + formatOneDecimal(avg) + ' percent.';
      }

      const brokerSelect = document.getElementById('brokerSelect');
      function onBrokerChange() {
        const brokerName = brokerSelect.value || 'IQ OPTION';
        let seed = 0; for (let i = 0; i < brokerName.length; i++) seed += brokerName.charCodeAt(i);
        const baseMean = 78 + ((seed % 12) + (new Date().getDate() % 5)) * 0.8;
        const volatility = 3.3;
        const values = generateSmoothedValues(baseMean, volatility);
        const labels = getLast7DayLabels();
        renderChart(labels, values);
        updateStatCard(values);
      }

      onBrokerChange();
      brokerSelect.addEventListener('change', onBrokerChange);

      // make chart responsive to container changes
      const canvas = document.getElementById('accuracyChart');
      const ro = new ResizeObserver(() => { if (accuracyChart) accuracyChart.update(); });
      ro.observe(canvas);
    });
  </script>
</body>
</html>
